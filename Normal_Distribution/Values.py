# X=[3.6336721547771296, 3.4376269383519173, 3.311900680806076, 3.2179715089593537, 3.142363189722934,
# 3.0787342042508747, 3.023578958629509, 2.974749439806321, 2.9308312807181984, 2.8908422031669114,
# 2.854071368045691, 2.819987246130248, 2.788181634353517, 2.7583340071667157, 2.7301879226172834,
# 2.703534891566473, 2.6782030398180385, 2.6540489463743215, 2.630951644375634, 2.608808130061539,
# 2.587529945545945, 2.5670405406106065, 2.5472732091638557, 2.5281694560370362, 2.509677690453935,
# 2.4917521705690153, 2.474352143162522, 2.4574411366137396, 2.4409863754157315, 2.4249582919199955,
# 2.4093301165008416, 2.394077531450501, 2.3791783770351747, 2.3646124005256586, 2.35036104085371,
# 2.3364072429738436, 2.322735297129525, 2.309330699106168, 2.2961800282554727, 2.283270840637334,
# 2.2705915750776526, 2.258131470306424, 2.245880491638469, 2.2338292659030414, 2.221969023529125,
# 2.2102915468589788, 2.198789123900082, 2.187454506840336, 2.176280874747408, 2.165261799953792,
# 2.1543912176972557, 2.1436633986439584, 2.1330729239705057, 2.122614662722928, 2.1122837512062658,
# 2.102075574189044, 2.091985747733258, 2.082010103483191, 2.07214467426604, 2.062385680874367,
# 2.052729519915192, 2.0431727526234758, 2.033712094549003, 2.0243444060355666, 2.015066683420017,
# 2.0058760508863553, 1.9967697529167867, 1.9877451472875602, 1.9787996985626854, 1.969930972043258,
# 1.9611366281342628, 1.9524144170943933, 1.9437621741377056, 1.9351778148588403, 1.926659330956166,
# 1.9182047862295295, 1.9098123128314064, 1.901480107752114, 1.8932064295214606, 1.8849895951107172,
# 1.8768279770201814, 1.868720000538845, 1.8606641411637965, 1.852658922168016, 1.8447029123061298,
# 1.8367947236485418, 1.8289330095351108, 1.8211164626402359, 1.8133438131418467, 1.805613826987362,
# 1.7979253042502115, 1.7902770775709869, 1.7826680106777337, 1.7750969969802894, 1.7675629582339412,
# 1.7600648432680168, 1.7526016267753275, 1.7451723081586634, 1.7377759104308066, 1.7304114791647636,
# 1.7230780814911406, 1.7157748051397859, 1.708500757523016, 1.7012550648579057, 1.6940368713252925,
# 1.6868453382632826, 1.6796796433931886, 1.6725389800759491, 1.6654225565972027, 1.6583295954792876,
# 1.651259332818545, 1.644211017646391, 1.63718391131271, 1.630177286890195, 1.6231904285983423,
# 1.6162226312458652, 1.6092731996903595, 1.602341448314107, 1.5954267005149592, 1.588528288211288,
# 1.5816455513600398, 1.5747778374869632, 1.5679245012281278, 1.561084903881875, 1.5542584129703823,
# 1.5474444018100455, 1.5406422490899099, 1.5338513384574064, 1.527071058110666, 1.520300800396707,
# 1.5135399614148026, 1.5067879406243527, 1.5000441404565903, 1.4933079659294677, 1.4865788242650704,
# 1.4798561245089135, 1.473139277150478, 1.466427693744343, 1.4597207865312707, 1.4530179680585975,
# 1.446318650799279, 1.439622246768925, 1.4329281671401561, 1.4262358218535982, 1.4195446192248165,
# 1.4128539655464734, 1.4061632646849758, 1.3994719176708534, 1.392779322282087, 1.3860848726195714,
# 1.3793879586738735, 1.3726879658824072, 1.3659842746761066, 1.3592762600146409, 1.3525632909091625,
# 1.3458447299315357, 1.3391199327089303, 1.3323882474026085, 1.3256490141696649, 1.3189015646064075,
# 1.312145221171988, 1.3053792965908027, 1.2986030932320962, 1.2918159024650888, 1.2850170039878452,
# 1.2782056651279772, 1.2713811401131392, 1.2645426693091326, 1.2576894784232764, 1.250820777670528,
# 1.2439357608996526, 1.2370336046765278, 1.23011346732145, 1.2231744878970587, 1.2162157851432251,
# 1.2092364563549522, 1.2022355761990093, 1.1952121954646624, 1.1881653397434695, 1.1810940080326706,
# 1.173997171256224, 1.1668737706970118, 1.1597227163331454, 1.1525428850706585, 1.1453331188641533,
# 1.1380922227161616, 1.1308189625451044, 1.123512062910734, 1.1161702045848514, 1.1087920219538512,
# 1.1013761002382774, 1.0939209725130294, 1.086425116510131, 1.0788869511840278, 1.0713048330171948,
# 1.0636770520413683, 1.056001827546923, 1.048277303449763, 1.0405015432815115, 1.032672524764703,
# 1.0247881339300544, 1.0168461587275703, 1.008844282077189, 1.0007800742976936, 0.9926509848446123,
# 0.9844543332785858, 0.9761872993749918, 0.9678469122732273, 0.959430038549625, 0.9509333690811663,
# 0.9423534045474647, 0.9336864393953785, 0.9249285440633781, 0.9160755452305841, 0.9071230038171677,
# 0.8980661904172587, 0.8889000577910002, 0.8796192099769164, 0.8702178675067043, 0.860689828108707,
# 0.8510284221694918, 0.8412264620798039, 0.8312761844148135, 0.821169183680031, 0.8108963360817699,
# 0.8004477114390329, 0.7898124709214972, 0.7789787477479784, 0.7679335072736622, 0.7566623819806559,
# 0.7451494756933992, 0.7333771297676894, 0.7213256419070726, 0.7089729254384062, 0.69629409303107,
# 0.6832609435298371, 0.669841323124786, 0.6559983214834005, 0.6416892481256015, 0.6268643116826462,
# 0.6114648905694418, 0.5954212309882102, 0.578649324876888, 0.5610465845336502, 0.5424857013585614,
# 0.5228056738123069, 0.5017982507346868, 0.479186603660292, 0.454590078199744, 0.4274622325658934,
# 0.39697289659508406, 0.36175827932632626, 0.31930356416603495, 0.26399487302724645, 0.17707528705666084,
# 0]
#
# Y=[0.0005417395552375069, 0.001083479110475014, 0.0016561136552670152, 0.002250486532574664, 0.002862208523129038,
# 0.0034886491406381295, 0.004128036566252825, 0.004779087510826185, 0.005440825239277036, 0.006112479029093788,
# 0.006793423819110817, 0.007483141658351745, 0.008181195856897916, 0.008887212965953399, 0.00960086980805204,
# 0.010321883889427355, 0.011050006150082657, 0.011785015373708067, 0.012526713803835752, 0.013274923654524604,
# 0.014029484296345903, 0.01479024996029363, 0.015557087844567809, 0.01632987653873934, 0.01710850470083,
# 0.017892869938045716, 0.018682877853061726, 0.019478441226063237, 0.020279479309001973, 0.021085917213299,
# 0.02189768537589667, 0.02271471909142038, 0.02353695810045331, 0.024364346225702212, 0.025196831049248875,
# 0.02603436362521979, 0.026876898223127606, 0.027724392097888358, 0.028576805283132806, 0.029434100404937106,
# 0.03029624251351778, 0.031163198930785636, 0.03203493911194557, 0.03291143451957599, 0.03379265850882842,
# 0.03467858622256464, 0.03556919449539875, 0.03646446176573902, 0.03736436799503532, 0.03826889459353163,
# 0.03917802435190537, 0.04009174137824563, 0.04101003103988425, 0.04193287990964709, 0.04286027571613919,
# 0.04379220729771944, 0.04472866455985537, 0.045669638435581264, 0.04661512084881, 0.04756510468027444,
# 0.04851958373589574, 0.04947855271739563, 0.050442007194987044, 0.05140994358199291, 0.05238235911125702,
# 0.05335925181322306, 0.05434062049556912, 0.05532646472429522, 0.05631678480616994, 0.057311581772450916,
# 0.058310857363801254, 0.05931461401633017, 0.06032285484869271, 0.06133558365018878, 0.06235280486980649,
# 0.0633745236061598, 0.06440074559827422, 0.0654314772171784, 0.06646672545826308, 0.06750649793437147,
# 0.06855080286958903, 0.06959964909370235, 0.07065304603730026, 0.07171100372749178, 0.0727735327842187,
# 0.07384064441714121, 0.07491235042307838, 0.07598866318398605, 0.07706959566545621, 0.07815516141572461,
# 0.07924537456517325, 0.08034024982631698, 0.08143980249426418, 0.0825440484476425, 0.08365300414998247,
# 0.08476668665155214, 0.08588511359163739, 0.08700830320126351, 0.08813627430635448, 0.08926904633132741,
# 0.09040663930312047, 0.09154907385565356, 0.09269637123472159, 0.0938485533033218, 0.095005642547416,
# 0.09616766208213123, 0.09733463565840145, 0.09850658767005482, 0.09968354316135135, 0.10086552783497672,
# 0.10205256806049894, 0.10324469088329494, 0.10444192403395568, 0.10564429593817838, 0.10685183572715622,
# 0.10806457324847572, 0.10928253907753385, 0.11050576452948735, 0.11173428167174754, 0.11296812333703528,
# 0.11420732313701142, 0.11545191547649936, 0.11670193556831703, 0.11795741944873726, 0.11921840399359636,
# 0.12048492693507162, 0.12175702687915062, 0.12303474332381563, 0.12431811667796844, 0.12560718828112186,
# 0.12690200042388614, 0.12820259636928014, 0.12950902037489848, 0.13082131771596783, 0.13213953470932768,
# 0.1334637187383724, 0.13479391827899403, 0.1361301829265673, 0.13747256342402062, 0.1388211116910393,
# 0.1401758808544503, 0.14153692527984021, 0.14290430060446163, 0.1442780637714853, 0.14565827306566048,
# 0.1470449881504479, 0.1484382701066949, 0.1498381814729251, 0.15124478628732116, 0.15265815013148162,
# 0.1540783401760404, 0.1555054252282402, 0.15693947578155912, 0.15838056406749465, 0.15982876410961608,
# 0.16128415178000352, 0.16274680485819928, 0.16421680309280534, 0.16569422826586985, 0.1671791642602144,
# 0.16867169712986438, 0.17017191517375563, 0.1716799090129018, 0.17319577167122063, 0.17471959866023007,
# 0.17625148806784022, 0.17779154065148353, 0.17933985993584284, 0.18089655231545493, 0.1824617271624893,
# 0.18403549694002205, 0.18561797732115054, 0.18720928731431974, 0.1888095493952595, 0.19041888964596423,
# 0.19203743790117872, 0.19366532790289234, 0.19530269746338358, 0.19694968863740067, 0.19860644790411425,
# 0.20027312635952935, 0.2019498799201035, 0.20363686953838242, 0.20533426143153424, 0.20704222732374242,
# 0.2087609447035036, 0.21049059709697115, 0.2122313743585917, 0.21398347298039733, 0.21574709642144774,
# 0.21752245545905974, 0.2193097685636223, 0.2211092622989748, 0.2229211717505265, 0.22474574098351938,
# 0.226583223534087, 0.2284338829360455, 0.2302979932866693, 0.23217583985506274, 0.23406771973714313,
# 0.23597394256170834, 0.23789483125258212, 0.23983072285241974, 0.24178196941443106, 0.24374893896904504,
# 0.24573201657342178, 0.24773160545272718, 0.24974812824324924, 0.25178202834877766, 0.25383377142322183,
# 0.2559038469942473, 0.2579927702448119, 0.26010108397193704, 0.2622293607449296, 0.26437820528865374,
# 0.2665482571214531, 0.26874019348206063, 0.2709547325854777, 0.2731926372545441, 0.2754547189820176,
# 0.277741842487745, 0.2800549308473437, 0.2823949712832342, 0.2847630217265338, 0.2871602182800943,
# 0.2895877837399651, 0.29204703736625, 0.2945394061366635, 0.2970664377696815, 0.29962981587255466,
# 0.3022313776574224, 0.3048731347829657, 0.3075572980287318, 0.3102863067075352, 0.31306286398691313,
# 0.3158899796506964, 0.31877102232648324, 0.32170978389440935, 0.32471055976919594, 0.3277782501547805,
# 0.3309184894383409, 0.3341378139937944, 0.33744388343599546, 0.3408457779036451, 0.34435440622662855,
# 0.34798308055311883, 0.351748349439077, 0.35567124860049454, 0.3597792598052556, 0.36410954335390566,
# 0.36871463776234426, 0.3736734245054497, 0.37911491416720305, 0.3852799062246806, 0.3927365053413033,
# 0.39894228]

from scipy import *
import scipy.optimize
from scipy.integrate import quad
from math import *
import numpy as np
from matplotlib.pyplot import plot, scatter
import matplotlib.pyplot as plt

# redefine Transcendental functions for proper precision
exp = lambda x: np.exp(x, dtype=np.longdouble)
sqrt = lambda x: np.sqrt(x, dtype=np.longdouble)
power = lambda x, y: np.power(x, y, dtype=np.longdouble)

oneHalf = 1 / np.longdouble(2)

# Define parameters
imax = longdouble(152)
area = 1 / longdouble(imax)

# Wanted distribution
P = lambda x: (1 / sqrt(2 * pi)) * exp(-x * x * oneHalf)



# Calculate cap area

x = linspace(3.9, 7, 1000)

fig,axes= plt.subplots(figsize=(6,5))
plt.plot(x, P(x))
plt.fill_between(x,P(x),alpha=0.37)
axes.set_title('Normal Distribution')
axes.set_facecolor('#EBEBEB')
axes.grid(which='major', color='white', linewidth=1)
plt.xlim(3.9, 7,)
# plt.ylim(0, 0.42)
# plt.savefig('C:/Users/13862/Desktop/normal1.png')
plt.show()

# z
# 0.0008121487080853945 0.5245089410580424
# 0.00018091660181984714 0.8989224555453157
# numpy
# 0.000714080639147685 0.6876853880103617
# 0.000258193089981984 0.5175799357924531
# bm
# 0.0007953909568153561 0.5516593550562441
# 0.0003310346659181618 0.2231463323614578